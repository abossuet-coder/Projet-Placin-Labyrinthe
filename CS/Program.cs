using System;

class Program
{
    static char[,] laby = new char[30,30]
    {
        // Exemple simplifi√© avec quelques torches 'T' et sortie 'S'
        { '‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà'},
        { '‚ñà',' ',' ',' ',' ',' ','‚ñà',' ',' ',' ',' ',' ',' ',' ','‚ñà',' ',' ',' ',' ',' ','‚ñà',' ',' ',' ',' ',' ',' ',' ',' ','‚ñà'},
        { '‚ñà','T','‚ñà','‚ñà','‚ñà',' ','‚ñà',' ','‚ñà','‚ñà','‚ñà','‚ñà',' ',' ','‚ñà',' ','‚ñà','‚ñà','‚ñà',' ','‚ñà',' ','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà',' ',' ','‚ñà'},
        { '‚ñà',' ','‚ñà',' ',' ',' ','‚ñà',' ',' ',' ',' ','‚ñà',' ',' ','‚ñà',' ',' ',' ',' ',' ','‚ñà',' ',' ',' ',' ',' ','‚ñà',' ',' ','‚ñà'},
        { '‚ñà',' ','‚ñà',' ','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà',' ','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà',' ','‚ñà','‚ñà','‚ñà',' ','‚ñà','‚ñà','‚ñà',' ','‚ñà',' ',' ','‚ñà'},
        { '‚ñà',' ',' ',' ','‚ñà',' ',' ',' ',' ','‚ñà',' ',' ',' ',' ',' ',' ',' ',' ','‚ñà',' ',' ',' ',' ','‚ñà',' ',' ','‚ñà',' ',' ','‚ñà'},
        { '‚ñà','‚ñà','‚ñà',' ','‚ñà',' ','‚ñà','‚ñà',' ','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà',' ','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà',' ','‚ñà',' ',' ',' ',' ','‚ñà'},
        { '‚ñà',' ',' ',' ','‚ñà','T',' ','‚ñà',' ',' ',' ',' ',' ',' ',' ','‚ñà',' ',' ',' ',' ',' ','‚ñà',' ',' ','‚ñà','‚ñà','‚ñà','‚ñà',' ','‚ñà'},
        { '‚ñà',' ','‚ñà','‚ñà','‚ñà','‚ñà',' ','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà',' ','‚ñà','‚ñà','‚ñà','‚ñà',' ','‚ñà','‚ñà',' ',' ',' ',' ',' ','‚ñà',' ','‚ñà'},
        { '‚ñà',' ',' ',' ',' ','‚ñà',' ',' ',' ',' ',' ',' ',' ','‚ñà',' ',' ',' ',' ',' ',' ',' ',' ','‚ñà','‚ñà','‚ñà','‚ñà',' ','‚ñà',' ','‚ñà'},
        { '‚ñà',' ','‚ñà','‚ñà','T','‚ñà','‚ñà','‚ñà',' ','‚ñà','‚ñà','‚ñà',' ','‚ñà',' ','‚ñà','‚ñà','‚ñà',' ','‚ñà','‚ñà','‚ñà',' ',' ',' ','‚ñà',' ','‚ñà',' ','‚ñà'}, // Attention: Le '#' √©tait pr√©sent ici dans ton code, je l'ai laiss√©.
        { '‚ñà',' ',' ','‚ñà',' ',' ',' ','‚ñà',' ',' ',' ',' ',' ','‚ñà',' ',' ',' ',' ',' ',' ',' ','‚ñà',' ','‚ñà',' ','‚ñà',' ','‚ñà',' ','‚ñà'},
        { '‚ñà','‚ñà',' ','‚ñà','‚ñà','‚ñà',' ','‚ñà','‚ñà','‚ñà','‚ñà',' ','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà',' ','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà',' ','‚ñà',' ','‚ñà',' ',' ','‚ñà'},
        { '‚ñà',' ',' ',' ',' ','‚ñà',' ',' ',' ',' ','‚ñà',' ',' ',' ',' ',' ','‚ñà',' ',' ',' ',' ',' ',' ',' ','‚ñà',' ',' ',' ',' ','‚ñà'},
        { '‚ñà',' ','‚ñà','‚ñà',' ','‚ñà','‚ñà','‚ñà','‚ñà',' ','‚ñà','‚ñà','‚ñà',' ','‚ñà','‚ñà','‚ñà',' ','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà',' ','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà'},
        { '‚ñà',' ',' ','‚ñà',' ',' ',' ',' ',' ',' ',' ',' ','‚ñà',' ',' ',' ',' ',' ',' ',' ',' ',' ','‚ñà',' ',' ',' ',' ',' ',' ','‚ñà'},
        { '‚ñà','‚ñà',' ','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà',' ','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà',' ','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà',' ','‚ñà','‚ñà','‚ñà',' ','‚ñà'},
        { '‚ñà',' ',' ',' ',' ',' ',' ',' ',' ',' ','‚ñà',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','‚ñà',' ',' ','‚ñà'},
        { '‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà',' ','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà',' ','‚ñà',' ','‚ñà','‚ñà'},
        { '‚ñà',' ',' ',' ',' ',' ',' ',' ','‚ñà',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','‚ñà',' ',' ',' ','‚ñà',' ',' ','‚ñà'},
        { '‚ñà',' ','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà',' ','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà',' ','‚ñà',' ','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà'},
        { '‚ñà',' ',' ',' ',' ','‚ñà',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','‚ñà',' ',' ',' ',' ',' ',' ','‚ñà'},
        { '‚ñà','‚ñà','‚ñà','‚ñà',' ','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà',' ','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà',' ','‚ñà'},
        { '‚ñà',' ',' ',' ',' ',' ',' ',' ',' ','‚ñà',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','‚ñà',' ','‚ñà'},
        { '‚ñà',' ','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà',' ','‚ñà',' ','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà',' ','‚ñà','‚ñà','‚ñà'},
        { '‚ñà',' ',' ',' ',' ',' ',' ','‚ñà',' ',' ',' ','‚ñà',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','‚ñà'},
        { '‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà',' ','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà',' ','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà',' ','‚ñà'},
        { '‚ñà',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','‚ñà'},
        { '‚ñà',' ','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','S'},
        { '‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà','‚ñà'}
    };

    static int playerX = 1;
    static int playerY = 1;

    const int viewSize = 5; // 11x11 vue
    static int torchRange = 5;
    static int torchPower = 0; // commence sans torche
    static bool torchOn = false;

    static void Main()
    {
        Console.CursorVisible = false;

        while (true)
        {
            Draw();

            ConsoleKey key = Console.ReadKey(true).Key;
            int nextX = playerX;
            int nextY = playerY;

            switch (key)
            {
                case ConsoleKey.UpArrow: nextY--; break;
                case ConsoleKey.DownArrow: nextY++; break;
                case ConsoleKey.LeftArrow: nextX--; break;
                case ConsoleKey.RightArrow: nextX++; break;
            }

            if (laby[nextY, nextX] != '‚ñà')
            {
                playerX = nextX;
                playerY = nextY;

                // Ramassage torche
                if (laby[playerY, playerX] == 'T')
                {
                    torchPower = torchRange;
                    torchOn = true;
                    laby[playerY, playerX] = ' ';
                }

                // D√©cr√©mentation torche
                if (torchOn)
                {
                    torchPower--;
                    if (torchPower <= 0)
                        torchOn = false;
                }

                // V√©rifie sortie
                if (laby[playerY, playerX] == 'S')
                {
                    Console.Clear();
                    Draw();
                    Console.WriteLine("\nüéâ BRAVO ! Tu as trouv√© la sortie !");
                    break;
                }
            }

            Console.SetCursorPosition(0, 0);
        }
    }

    static void Draw()
    {
        for (int y = playerY - viewSize; y <= playerY + viewSize; y++)
        {
            for (int x = playerX - viewSize; x <= playerX + viewSize; x++)
            {
                if (y < 0 || y >= laby.GetLength(0) || x < 0 || x >= laby.GetLength(1))
                {
                    Console.Write("  "); // vide hors limites
                }
                else
                {
                    bool visible = false;

                    if (torchOn)
                    {
                        // simple ligne droite vision: si dans carr√© torchRange
                        if (Math.Abs(x - playerX) <= torchPower && Math.Abs(y - playerY) <= torchPower)
                            visible = true;
                    }
                    else
                    {
                        // vision autour du joueur sans torche
                        if (Math.Abs(x - playerX) <= 1 && Math.Abs(y - playerY) <= 1)
                            visible = true;
                    }

                    if (visible)
                    {
                        string c = (x == playerX && y == playerY) ? "PP" : $"{laby[y, x]}{laby[y, x]}";
                        Console.Write(c);
                    }
                    else
                        Console.Write("  "); // non visible
                }
            }
            Console.WriteLine();
        }
    }
}

sbgjhdgb